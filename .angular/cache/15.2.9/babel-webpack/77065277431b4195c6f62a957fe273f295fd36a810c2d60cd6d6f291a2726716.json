{"ast":null,"code":"import { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"../services/fetch.service\";\nimport * as i3 from \"@angular/material/dialog\";\nimport * as i4 from \"../core/core.service\";\nimport * as i5 from \"@angular/material/button\";\nexport let AgniveerEditComponent = /*#__PURE__*/(() => {\n  class AgniveerEditComponent {\n    constructor(_fb, _empService, _dialogRef, data, _coreService) {\n      this._fb = _fb;\n      this._empService = _empService;\n      this._dialogRef = _dialogRef;\n      this.data = data;\n      this._coreService = _coreService;\n      this.display = 'Allow Bookout';\n      this.error = false;\n      this.empForm = this._fb.group({\n        id: '',\n        name: '',\n        checkSuffix: '',\n        trade: '',\n        unit: '',\n        recommendation: '',\n        bookout: '',\n        bookedIn: '',\n        postIn: '',\n        late: '',\n        bookoutDetails: [{\n          bookoutDate: '',\n          bookinDate: ''\n        }],\n        imgUrl: ''\n      });\n    }\n    ngOnInit() {\n      this.empForm.patchValue(this.data.value);\n      if (this.data.name == 'adjRev') {\n        this.display = 'Revoke Bookout';\n      }\n      if (this.data.name == 'adjRec') {\n        this.display = 'Recommend Bookout';\n      }\n      if (this.data.name == 'secoffrBookout') {\n        this.display = 'Allow Bookout';\n      }\n      if (this.data.name == 'secoffrBookin') {\n        this.display = \"Booking In\";\n      }\n    }\n    onFormSubmit() {\n      if (this.empForm.valid) {\n        if (this.data.name == 'adjRec') {\n          this.empForm.patchValue({\n            recommendation: true\n          });\n          console.log(this.empForm);\n        } else if (this.data.name == 'adjRev') {\n          this.empForm.patchValue({\n            recommendation: false,\n            bookout: false\n          });\n          console.log(this.empForm);\n        } else if (this.data.name == 'secoffrBookout') {\n          const bookoutDetails = this.empForm.controls['bookoutDetails'];\n          let currentDate = new Date();\n          this.empForm.patchValue({\n            bookout: false\n          });\n          if (bookoutDetails.getRawValue()) {\n            const temp = {\n              bookoutDate: currentDate,\n              bookinDate: null\n            };\n            bookoutDetails.getRawValue().push(temp);\n          }\n          this.empForm.patchValue({\n            bookedIn: false\n          });\n        } else if (this.data.name == 'secoffrBookin') {\n          let currentDate = new Date();\n          const bookoutDetails = this.empForm.controls['bookoutDetails'];\n          console.log(bookoutDetails.getRawValue());\n          if (bookoutDetails.getRawValue()) {\n            let temp = bookoutDetails.getRawValue().at(bookoutDetails.getRawValue.length - 1);\n            let bookoutDateTemp = new Date(temp.bookoutDate);\n            console.log(bookoutDateTemp);\n            if (bookoutDateTemp.getDate() != currentDate.getDate()) {\n              this.error = true;\n            }\n            let temp1 = {\n              bookoutDate: temp.bookoutDate,\n              bookinDate: currentDate\n            };\n            bookoutDetails.getRawValue().splice(length - 1);\n            bookoutDetails.getRawValue().push(temp1);\n            this.empForm.patchValue({\n              bookedIn: true,\n              bookout: false,\n              recommendation: false\n            });\n          }\n        }\n        if (this.data.value) {\n          this._empService.updateAgniveer(this.data.value.id, this.empForm.value).subscribe({\n            next: val => {\n              if (this.error == false) {\n                this._coreService.openSnackBar('Agniveer detail updated!');\n                this._dialogRef.close(true);\n              } else {\n                this._coreService.openSnackBar('Booking in on another day. Meet Security Officer.');\n                this._dialogRef.close(true);\n              }\n            },\n            error: err => {\n              console.error(err);\n            }\n          });\n        }\n      }\n    }\n  }\n  AgniveerEditComponent.ɵfac = function AgniveerEditComponent_Factory(t) {\n    return new (t || AgniveerEditComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.FetchService), i0.ɵɵdirectiveInject(i3.MatDialogRef), i0.ɵɵdirectiveInject(MAT_DIALOG_DATA), i0.ɵɵdirectiveInject(i4.CoreService));\n  };\n  AgniveerEditComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AgniveerEditComponent,\n    selectors: [[\"agniveer-edit\"]],\n    decls: 10,\n    vars: 4,\n    consts: [[3, \"formGroup\", \"ngSubmit\"], [\"mat-dialog-content\", \"\", 1, \"content\"], [1, \"row\", 2, \"padding-left\", \"8px\"], [\"mat-dialog-actions\", \"\", 1, \"action\"], [\"mat-raised-button\", \"\", \"type\", \"button\", 3, \"mat-dialog-close\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"type\", \"submit\"]],\n    template: function AgniveerEditComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"form\", 0);\n        i0.ɵɵlistener(\"ngSubmit\", function AgniveerEditComponent_Template_form_ngSubmit_0_listener() {\n          return ctx.onFormSubmit();\n        });\n        i0.ɵɵelementStart(1, \"div\", 1)(2, \"div\", 2)(3, \"b\");\n        i0.ɵɵtext(4);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(5, \"div\", 3)(6, \"button\", 4);\n        i0.ɵɵtext(7, \"Cancel\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"button\", 5);\n        i0.ɵɵtext(9);\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"formGroup\", ctx.empForm);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(ctx.display);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"mat-dialog-close\", false);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(\"Update\");\n      }\n    },\n    dependencies: [i1.ɵNgNoValidate, i1.NgControlStatusGroup, i5.MatButton, i3.MatDialogClose, i3.MatDialogContent, i3.MatDialogActions, i1.FormGroupDirective],\n    styles: [\".content[_ngcontent-%COMP%]{padding-top:20px}.row[_ngcontent-%COMP%]{display:flex;gap:10px}.row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.action[_ngcontent-%COMP%]{padding:0 25px 20px}.action[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1}\"]\n  });\n  return AgniveerEditComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}